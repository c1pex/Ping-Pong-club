<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Купить абонемент в PingPong Club | Тарифы и цены</title>
  <meta name="description" content="Выберите подходящий абонемент для игры в настольный теннис. Гибкие тарифы на месяц, полгода или год. Неограниченный доступ и скидки на тренировки.">
  <meta name="keywords" content="абонементы, цены, тарифы, купить абонемент настольный теннис, клубная карта">
  <meta name="robots" content="index, follow">
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- ДОБАВЛЕНО: Stripe.js -->
  <script src="https://js.stripe.com/v3/"></script>
  <!-- ДОБАВЛЕНО: SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: {
          'montserrat': ['Montserrat', 'sans-serif'],
        },
        colors: {
          'pingpong-blue': '#1e40af',
          'pingpong-orange': '#ea580c',
        }
      }
    }
  }
</script>
  <style>
    body {
        font-family: 'Montserrat', sans-serif;
    }
    .subscription-card {
        transition: all 0.3s ease;
        border: 3px solid transparent;
    }
    .subscription-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    }
    /* ИСПРАВЛЕНО: :popular на .popular */
    .subscription-card.popular {
        border-color: #3b82f6;
        position: relative;
    }
    .popular-badge {
        position: absolute;
        top: -12px;
        right: 20px;
        background: #3b82f6;
        color: white;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }
    .feature-list li {
        transition: all 0.2s ease;
    }
    .feature-list li:hover {
        transform: translateX(5px);
    }
    /* ДОБАВЛЕНО: Стили для Stripe Elements */
    .StripeElement {
        box-sizing: border-box;
        padding: 10px 12px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        background-color: white;
    }
    .StripeElement--focus {
        border-color: #3b82f6;
        box-shadow: 0 0 0 1px #3b82f6;
    }
    .StripeElement--invalid {
        border-color: #ef4444;
    }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-montserrat">

    <!-- Навигация -->
  <header class="bg-white shadow-lg sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <a href="index.html" class="text-2xl font-bold flex items-center space-x-2 text-pingpong-blue">
        <i class="fas fa-table-tennis-paddle-ball text-pingpong-orange"></i>
        <span>PingPong Club</span>
      </a>
      <nav class="hidden md:flex space-x-8">
        <a href="index.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">Главная</a>
        <a href="about.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">О нас</a>
        <a href="tournaments.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">Турниры</a>
        <a href="training.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">Тренировки</a>
        <a href="booking.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">Бронирование</a>
        <a href="subscriptions.html" class="font-medium text-pingpong-blue border-b-2 border-pingpong-blue pb-1">Абонементы</a>
        <a href="contacts.html" class="font-medium text-gray-600 hover:text-pingpong-blue transition">Контакты</a>
      </nav>
      <div class="flex items-center space-x-4">
        <a href="profile.html" class="bg-pingpong-blue text-white px-4 py-2 rounded-lg hover:bg-blue-800 transition font-medium auth-button">
          <i class="fas fa-user mr-2"></i>Профиль
        </a>
        <button class="md:hidden text-gray-600">
          <i class="fas fa-bars text-xl"></i>
        </button>
      </div>
    </div>
  </header>

<!-- Хлебные крошки -->
  <nav class="bg-gray-100 py-4">
    <div class="max-w-7xl mx-auto px-4">
      <ol class="flex items-center space-x-2 text-sm">
        <li>
          <a href="index.html" class="text-pingpong-blue hover:text-pingpong-orange transition">
            <i class="fas fa-home mr-1"></i>Главная
          </a>
        </li>
        <li class="flex items-center">
          <i class="fas fa-chevron-right text-gray-400 text-xs"></i>
        </li>
        <li class="text-gray-600">
          <span>Абонементы</span>
        </li>
      </ol>
    </div>
  </nav>

  <!-- Основной контент -->
  <div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Заголовок -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-gray-800 mb-4">Абонементы на игру</h1>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">
        Экономьте до 40% при покупке абонемента. Играйте чаще - платите меньше!
      </p>
    </div>

    <!-- Тарифы -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16">
      <!-- Начальный -->
      <div class="subscription-card bg-white rounded-xl shadow-lg p-6 text-center">
        <h3 class="text-2xl font-bold mb-4">Начальный</h3>
        <div class="mb-6">
          <span class="text-4xl font-bold text-gray-800">1 500 ₽</span>
          <span class="text-gray-600">/месяц</span>
        </div>
        <ul class="feature-list space-y-3 mb-6 text-left">
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>10 часов игры</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Любые столы</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Бесплатная аренда ракеток</span>
          </li>
          <li class="flex items-center text-gray-400">
            <i class="fas fa-times text-red-400 mr-3"></i>
            <span>Участие в турнирах</span>
          </li>
          <li class="flex items-center text-gray-400">
            <i class="fas fa-times text-red-400 mr-3"></i>
            <span>Персональные тренировки</span>
          </li>
        </ul>
        <button class="w-full bg-gray-600 text-white py-3 rounded-lg hover:bg-gray-700 transition font-semibold subscribe-btn" data-plan="beginner" data-price="1500">
          Выбрать тариф
        </button>
      </div>

      <!-- Стандарт -->
      <div class="subscription-card bg-white rounded-xl shadow-lg p-6 text-center popular">
        <div class="popular-badge">ПОПУЛЯРНЫЙ</div>
        <h3 class="text-2xl font-bold mb-4">Стандарт</h3>
        <div class="mb-6">
          <span class="text-4xl font-bold text-gray-800">2 500 ₽</span>
          <span class="text-gray-600">/месяц</span>
          <div class="text-sm text-green-600 font-medium mt-1">Экономия 30%</div>
        </div>
        <ul class="feature-list space-y-3 mb-6 text-left">
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>20 часов игры</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Профессиональные столы</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Бесплатная аренда ракеток</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Участие в турнирах</span>
          </li>
          <li class="flex items-center text-gray-400">
            <i class="fas fa-times text-red-400 mr-3"></i>
            <span>Персональные тренировки</span>
          </li>
        </ul>
        <button class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition font-semibold subscribe-btn" data-plan="standard" data-price="2500">
          Выбрать тариф
        </button>
      </div>

      <!-- Премиум -->
      <div class="subscription-card bg-white rounded-xl shadow-lg p-6 text-center">
        <h3 class="text-2xl font-bold mb-4">Премиум</h3>
        <div class="mb-6">
          <span class="text-4xl font-bold text-gray-800">4 000 ₽</span>
          <span class="text-gray-600">/месяц</span>
          <div class="text-sm text-green-600 font-medium mt-1">Экономия 40%</div>
        </div>
        <ul class="feature-list space-y-3 mb-6 text-left">
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Неограниченные часы</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Все столы без ограничений</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Премиум ракетки</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Приоритет в турнирах</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>2 персональные тренировки</span>
          </li>
        </ul>
        <button class="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition font-semibold subscribe-btn" data-plan="premium" data-price="4000">
          Выбрать тариф
        </button>
      </div>

      <!-- Годовой -->
      <div class="subscription-card bg-white rounded-xl shadow-lg p-6 text-center">
        <h3 class="text-2xl font-bold mb-4">Годовой</h3>
        <div class="mb-6">
          <span class="text-4xl font-bold text-gray-800">25 000 ₽</span>
          <span class="text-gray-600">/год</span>
          <div class="text-sm text-green-600 font-medium mt-1">Экономия 45%</div>
        </div>
        <ul class="feature-list space-y-3 mb-6 text-left">
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Неограниченные часы</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Все столы без ограничений</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Персональный шкафчик</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>Бесплатные напитки</span>
          </li>
          <li class="flex items-center">
            <i class="fas fa-check text-green-500 mr-3"></i>
            <span>12 персональных тренировок</span>
          </li>
        </ul>
        <button class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition font-semibold subscribe-btn" data-plan="yearly" data-price="25000">
          Выбрать тариф
        </button>
      </div>
    </div>

    <!-- Сравнение тарифов -->
    <div class="bg-white rounded-xl shadow-lg p-8 mb-12">
      <h2 class="text-3xl font-bold text-center mb-8">Сравнение тарифов</h2>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b-2 border-gray-200">
              <th class="text-left py-4 font-semibold">Возможности</th>
              <th class="text-center py-4 font-semibold">Начальный</th>
              <th class="text-center py-4 font-semibold">Стандарт</th>
              <th class="text-center py-4 font-semibold">Премиум</th>
              <th class="text-center py-4 font-semibold">Годовой</th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-gray-100">
              <td class="py-4 font-medium">Часы игры в месяц</td>
              <td class="text-center py-4">10</td>
              <td class="text-center py-4">20</td>
              <td class="text-center py-4">Неограниченно</td>
              <td class="text-center py-4">Неограниченно</td>
            </tr>
            <tr class="border-b border-gray-100">
              <td class="py-4 font-medium">Тип столов</td>
              <td class="text-center py-4">Любые</td>
              <td class="text-center py-4">Профессиональные</td>
              <td class="text-center py-4">Все без ограничений</td>
              <td class="text-center py-4">Все без ограничений</td>
            </tr>
            <tr class="border-b border-gray-100">
              <td class="py-4 font-medium">Аренда ракеток</td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
            </tr>
            <tr class="border-b border-gray-100">
              <td class="py-4 font-medium">Участие в турнирах</td>
              <td class="text-center py-4"><i class="fas fa-times text-red-400"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
              <td class="text-center py-4"><i class="fas fa-check text-green-500"></i></td>
            </tr>
            <tr class="border-b border-gray-100">
              <td class="py-4 font-medium">Персональные тренировки</td>
              <td class="text-center py-4"><i class="fas fa-times text-red-400"></i></td>
              <td class="text-center py-4"><i class="fas fa-times text-red-400"></i></td>
              <td class="text-center py-4">2 в месяц</td>
              <td class="text-center py-4">1 в месяц</td>
            </tr>
            <tr>
              <td class="py-4 font-medium">Стоимость часа</td>
              <td class="text-center py-4">150 ₽</td>
              <td class="text-center py-4">125 ₽</td>
              <td class="text-center py-4">~80 ₽</td>
              <td class="text-center py-4">~70 ₽</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- FAQ -->
    <div class="bg-white rounded-xl shadow-lg p-8">
      <h2 class="text-3xl font-bold text-center mb-8">Частые вопросы</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <h3 class="text-xl font-semibold mb-4">Как работает абонемент?</h3>
          <p class="text-gray-600 mb-6">
            Абонемент дает вам фиксированное количество часов игры в месяц. При бронировании стола время автоматически списывается с вашего баланса.
          </p>
          
          <h3 class="text-xl font-semibold mb-4">Можно ли продлить абонемент?</h3>
          <p class="text-gray-600">
            Да, абонемент автоматически продлевается каждый месяц. Вы можете отменить автопродление в любое время в личном кабинете.
          </p>
        </div>
        <div>
          <h3 class="text-xl font-semibold mb-4">Что если я не использовал все часы?</h3>
          <p class="text-gray-600 mb-6">
            Неиспользованные часы не переносятся на следующий месяц. Рекомендуем выбирать тариф, соответствующий вашей активности.
          </p>
          
          <h3 class="text-xl font-semibold mb-4">Как оплатить абонемент?</h3>
          <p class="text-gray-600">
            Оплата происходит онлайн банковской картой. После оплаты абонемент активируется мгновенно.
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Подвал -->
  <footer class="bg-gray-900 text-white py-12 mt-12">
    <div class="max-w-7xl mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-xl font-bold mb-4 flex items-center">
            <i class="fas fa-table-tennis-paddle-ball text-pingpong-orange mr-2"></i>
            PingPong Club
          </h3>
          <p class="text-gray-400">Лучший клуб настольного тенниса в вашем городе.</p>
        </div>
        <div>
          <h4 class="font-bold mb-4">Навигация</h4>
          <ul class="space-y-2">
            <li><a href="index.html" class="text-gray-400 hover:text-white transition">Главная</a></li>
            <li><a href="about.html" class="text-gray-400 hover:text-white transition">О нас</a></li>
            <li><a href="tournaments.html" class="text-gray-400 hover:text-white transition">Турниры</a></li>
            <li><a href="training.html" class="text-gray-400 hover:text-white transition">Тренировки</a></li>
            <li><a href="booking.html" class="text-gray-400 hover:text-white transition">Бронирование</a></li>
            <li><a href="subscriptions.html" class="text-gray-400 hover:text-white transition">Абонементы</a></li>
            <li><a href="contacts.html" class="text-gray-400 hover:text-white transition">Контакты</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Контакты</h4>
          <ul class="space-y-2 text-gray-400">
            <li class="flex items-center"><i class="fas fa-map-marker-alt mr-2"></i> г. Москва, ул. Спортивная, 15</li>
            <li class="flex items-center"><i class="fas fa-phone mr-2"></i> +7 (999) 123-45-67</li>
            <li class="flex items-center"><i class="fas fa-envelope mr-2"></i> info@pingpongclub.ru</li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-4">Мы в соцсетях</h4>
          <div class="flex space-x-4">
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-vk text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-telegram text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-instagram text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-youtube text-xl"></i></a>
          </div>
        </div>
      </div>
      <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
        <p>&copy; 2025 PingPong Club. Все права защищены.</p>
      </div>
    </div>
  </footer>

  <!-- ОСНОВНОЙ СКРИПТ ДЛЯ РАБОТЫ С АБОНЕМЕНТАМИ -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

    // Инициализация Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyCIfPeJSURQW_TNBYvaKcsX6bDtMLwr-ZE",
        authDomain: "tennizov.firebaseapp.com",
        databaseURL: "https://tennizov-default-rtdb.firebaseio.com",
        projectId: "tennizov",
        storageBucket: "tennizov.appspot.com",
        messagingSenderId: "194989527761",
        appId: "1:194989527761:web:c0a4ba1fcf9484709fabf0"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Инициализация Stripe с тестовым ключом
    const stripe = Stripe('pk_test_51SQNQRGVzR3K59msBwN065DfCupjMClSZACosrczmSIuT5rLS15V9H8tlp3V5IxErxAWgnYrAWZuvPW25twBzuS000aEIMBAbk');

    // Данные тарифов
    const plans = {
        beginner: { 
            name: "Начальный", 
            price: "1 500 ₽", 
            amount: 1500,
            description: "10 часов игры в месяц"
        },
        standard: { 
            name: "Стандарт", 
            price: "2 500 ₽", 
            amount: 2500,
            description: "20 часов игры в месяц"
        },
        premium: { 
            name: "Премиум", 
            price: "4 000 ₽", 
            amount: 4000,
            description: "Неограниченные часы игры"
        },
        yearly: { 
            name: "Годовой", 
            price: "25 000 ₽", 
            amount: 25000,
            description: "Неограниченные часы на весь год"
        }
    };

    // Функция для показа уведомлений
    function showAlert(icon, title, text) {
        Swal.fire({
            icon: icon,
            title: title,
            text: text,
            confirmButtonColor: '#1e40af'
        });
    }

    // Обработчики для кнопок выбора тарифа
    document.addEventListener('DOMContentLoaded', function() {
        const subscribeButtons = document.querySelectorAll('.subscribe-btn');
        
        subscribeButtons.forEach(button => {
            button.addEventListener('click', function() {
                const plan = this.getAttribute('data-plan');
                showPaymentModal(plan);
            });
        });
    });

    // Функция показа модального окна оплаты
    function showPaymentModal(plan) {
        const planData = plans[plan];
        const user = auth.currentUser;
        
        if (!user) {
            showAlert('warning', 'Требуется авторизация', 'Для покупки абонемента необходимо войти в систему');
            setTimeout(() => {
                window.location.href = 'authorization.html';
            }, 2000);
            return;
        }

        const modalHTML = `
            <div id="paymentModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 transition-opacity duration-300">
                <div class="bg-white rounded-xl shadow-2xl p-8 max-w-lg w-full transform transition-all duration-300 scale-100 font-montserrat">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-2xl font-bold">Оплата абонемента</h3>
                        <button onclick="closePaymentModal()" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                        <h4 class="font-semibold text-blue-800 text-lg">${planData.name}</h4>
                        <p class="text-blue-700">${planData.description}</p>
                        <div class="text-2xl font-bold text-blue-800 mt-2">${planData.price}</div>
                    </div>
                    
                    <form id="payment-form">
                        <div class="space-y-4 mb-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email для чека</label>
                                <input type="email" id="email" value="${user.email}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Имя для чека</label>
                                <input type="text" id="name" value="${user.displayName || ''}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Данные карты</label>
                                <div id="card-element" class="p-3 border border-gray-300 rounded-lg">
                                    <!-- Stripe Elements будет здесь -->
                                </div>
                                <div id="card-errors" role="alert" class="text-red-500 text-sm mt-2"></div>
                            </div>
                        </div>

                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6">
                            <p class="text-sm text-yellow-800 text-center">
                                <i class="fas fa-info-circle mr-1"></i>
                                Для теста используйте карту: 4242 4242 4242 4242
                            </p>
                        </div>

                        <div class="flex space-x-4 justify-end">
                            <button type="button" onclick="closePaymentModal()" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition font-medium">
                                Отмена
                            </button>
                            <button type="submit" id="submit-button" class="bg-pingpong-blue text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition font-medium">
                                Оплатить ${planData.price}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        initializeStripe(planData);
    }

    // Инициализация Stripe Elements
    function initializeStripe(planData) {
        const elements = stripe.elements();
        const cardElement = elements.create('card', {
            style: {
                base: {
                    fontSize: '16px',
                    color: '#32325d',
                    '::placeholder': {
                        color: '#aab7c4',
                    },
                },
            },
        });

        cardElement.mount('#card-element');

        const form = document.getElementById('payment-form');
        const submitButton = document.getElementById('submit-button');
        const cardErrors = document.getElementById('card-errors');

        cardElement.on('change', function(event) {
            if (event.error) {
                cardErrors.textContent = event.error.message;
            } else {
                cardErrors.textContent = '';
            }
        });

        form.addEventListener('submit', async function(event) {
            event.preventDefault();
            
            submitButton.disabled = true;
            submitButton.textContent = 'Обработка...';

            const email = document.getElementById('email').value;
            const name = document.getElementById('name').value;

            try {
                // Создаем Payment Method
                const { paymentMethod, error } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement,
                    billing_details: {
                        name: name,
                        email: email,
                    },
                });

                if (error) {
                    cardErrors.textContent = error.message;
                    submitButton.disabled = false;
                    submitButton.textContent = `Оплатить ${planData.price}`;
                    return;
                }

                // Имитация успешной оплаты
                simulatePaymentSuccess(planData);
                
            } catch (err) {
                cardErrors.textContent = 'Произошла ошибка при обработке платежа';
                submitButton.disabled = false;
                submitButton.textContent = `Оплатить ${planData.price}`;
            }
        });
    }

    // Имитация успешной оплаты
    function simulatePaymentSuccess(planData) {
        closePaymentModal();
        
        Swal.fire({
            icon: 'success',
            title: 'Поздравляем!',
            html: `
                <div class="text-center">
                    <i class="fas fa-check-circle text-green-500 text-5xl mb-4"></i>
                    <h3 class="text-2xl font-bold mb-3 text-gray-800">Оплата прошла успешно!</h3>
                    <p class="text-lg text-gray-600 mb-4">
                        Вы приобрели тариф <strong>${planData.name}</strong>
                    </p>
                    <p class="text-gray-500">Абонемент активирован и готов к использованию</p>
                </div>
            `,
            confirmButtonText: 'Отлично!',
            confirmButtonColor: '#1e40af',
        });
    }

    // Закрытие модального окна
    function closePaymentModal() {
        const modal = document.getElementById('paymentModal');
        if (modal) {
            modal.remove();
        }
    }

    // Управление авторизацией
    onAuthStateChanged(auth, (user) => {
        const authButton = document.querySelector('.auth-button');
        
        if (user) {
            authButton.innerHTML = `<i class="fas fa-user mr-2"></i>${user.displayName || user.email}`;
            authButton.href = "profile.html";
        } else {
            authButton.innerHTML = '<i class="fas fa-sign-in-alt mr-2"></i>Вход';
            authButton.href = "authorization.html";
        }
    });

    // Делаем функции глобальными
    window.showPaymentModal = showPaymentModal;
    window.closePaymentModal = closePaymentModal;
  </script>
</body>
</html>